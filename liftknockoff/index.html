<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" >
    <link rel="stylesheet" href="style.css" type="text/css">
    <title>Car Service</title>
    <script>
            var myLat = 000;
            var myLng = 000;
            console.log("before getlocation");
            function getLocation() {
            console.log("in getlocation");
            navigator.geolocation.getCurrentPosition(getPosition);
    
            function getPosition(position) {
                myLat = position.coords.latitude;
                myLng = position.coords.longitude;
                console.log("lat and lng are " + myLat + ", " + myLng);
                }
            }
            console.log("after getlocation");
    </script> 

    <script>
        var map;
    
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {center: {lat: 42.5, lng: -71}, zoom: 10});
            //use mapOptions to change the lat and long to make more sense later
        }
        console.log("initialized map and now going to getlocation");
        getLocation();
    </script>
    
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC9sQaGQMUn1TEZG3C11LjRlpQAppS4WGk&callback=initMap" async defer></script> 
    <!-- link with my API key: (error keeps telling me I need to activate it?)-->
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBwUBWoCug3Rd4myBqKkSHOAc2rCWEYiO0&callback=initMap" async defer></script> -->
    
    <script>
        request = new XMLHttpRequest();
    
        request.open("POST", "https://hans-moleman.herokuapp.com/rides", true);
    
        request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

        request.onreadystatechange = function() {
            if (request.readyState == 4 && request.status == 200) {
                    passengers = JSON.parse(request.responseText);
                    //user = document.getElementById("username");
                    //latitude = document.getElementById("lat");
                    //longitude = document.getElementById("lng");
                    locations = document.getElementById("requests");
                    for (i=0; i<passengers.length; i++) {
                        locations.innerHTML += "<p>" + passengers[i].username + " location is " + passengers[i].lat + ", " + passengers[i].lng + "</p>";
                    }
                }
            }

        request.send("username=VFadwaWF&lat="+myLat+"&lng="+myLng);
        </script> 
</head>

<body>
    <div id="map"></div>

    <h1>hi world</h1>
</body>
</html>